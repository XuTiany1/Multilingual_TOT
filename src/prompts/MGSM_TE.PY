USER_CHAT_TEMPLATE = "<start_of_turn>వినియోగదారు\n{prompt}<end_of_turn><eos>\n"
MODEL_CHAT_TEMPLATE = "<start_of_turn>మోడల్\n"

# standard prompt
standard_prompt = USER_CHAT_TEMPLATE.format(
    prompt="కింద ఇచ్చిన గణిత ప్రశ్నకు సమాధానం ఇవ్వండి. చివరి సమాధానాన్ని కేవలం ఒక సంఖ్యగా మాత్రమే ఇవ్వండి, ఇతర ఏమీ చేర్చవద్దు.\n"
) + "{question}\nసమాధానం: " + MODEL_CHAT_TEMPLATE

# cot prompt
cot_prompt = USER_CHAT_TEMPLATE.format(
    prompt="కింద ఇచ్చిన గణిత ప్రశ్నకు సమాధానం ఇవ్వండి. "
           "దశల వారీగా ఆలోచించి, మీ ఆలోచనా విధానాన్ని క్రింద వ్రాయండి. "
           "చివరి లైన్ 'సమాధానం xxx' లా ఉండాలి, ఇక్కడ xxx ఒక సంఖ్య.\n"
) + "ప్రశ్న: {question}\nదశల వారీగా సమాధానం:\n" + MODEL_CHAT_TEMPLATE

# propose_prompt
propose_prompt = USER_CHAT_TEMPLATE.format(
    prompt="కల్పించుకోండి कि మీరు {n} స్వతంత్ర గణిత శాస్త్రవేత్తలతో రూపొందించబడ్డారు, వారు {lang} మాట్లాడుతున్నారు, "
           "ప్రతి ఒక్కరూ బహుళ-దశ గణిత సమస్యను పరిష్కరించడానికి ఒక ప్రత్యేక దృక్కోణాన్ని కలిగి ఉంటారు.\n\n"
           "ప్రతి గణిత శాస్త్రవేత్త సమస్యను పరిష్కరించడానికి ఒక స్పష్టమైన దశను సూచిస్తారు. "
           "ఆ దశలో ఈ క్రింది అంశాలు ఉండాలి:\n"
           "- **సంక్షిప్త వివరణ**, ఈ దశ ఎందుకు అవసరం మరియు ఇది సమస్యను ఎలా పరిష్కరిస్తుందో.\n"
           "- **స్పష్టమైన సమీకరణం** లేదా లెక్కింపు, ఇది ఈ దశను అమలు చేస్తుంది.\n"
           "- తదుపరి తర్కబద్ధమైన దశ ఏమిటో ఒక సంక్షిప్త సూచన.\n\n"
           "ప్రతి గణిత శాస్త్రవేత్త వారి సమాధానాన్ని 'ఆలోచన i: ' తో ప్రారంభించాలి, ఇక్కడ 'i' అనేది 1, 2, ... {n}.\n\n"
           "సమాధానాలు **ఒకే వరుసలో** ఈ ఫార్మాట్‌లో రాయాలి:\n\n"
           "గణితీయ సమీకరణం లెక్కించిన విలువతో ముగుస్తుంది.\n\n"
           "'ఆలోచన i: ప్రతిపాదన. సమీకరణం: [గణితీయ ప్రకటన]. తదుపరి దశ: తదుపరి చర్య.'\n\n"
           "ప్రతి గణిత శాస్త్రవేత్త సమస్యను స్వతంత్రంగా పరిశీలించాలి, విభిన్న పద్ధతులు లేదా విభజనలను పరిగణనలోకి తీసుకోవాలి.\n\n"
           "ఇది మొదటి దశ అయితే, ప్రతి గణిత శాస్త్రవేత్త స్వతంత్రంగా ప్రారంభించే ఉత్తమ మార్గాన్ని నిర్ణయిస్తారు.\n"
           "మునుపటి సందర్భం ఉంటే, వారు ప్రస్తుత ఆలోచనా ప్రక్రియపై నిర్మించి, ముందుకు సాగడానికి నిర్ధారిస్తారు.\n\n"
           "ఈ ప్రక్రియ ఒక నిర్దిష్ట సమాధానం పొందే వరకు కొనసాగుతుంది, ప్రతి దశ పరిష్కారాన్ని మెరుగుపరుస్తుంది.\n\n"
) + "---\n" \
    "ప్రశ్న: {question}\n\n" \
    "సందర్భం (మునుపటి ఆలోచనా ప్రక్రియ, ఉంటే):\n{current_thought_process}\n\n" \
    "మూడు గణిత శాస్త్రవేత్తలు సూచించిన స్పష్టమైన దశలు:\n" \
    + MODEL_CHAT_TEMPLATE

# value_prompt
value_prompt = USER_CHAT_TEMPLATE.format(
    prompt="ఇచ్చిన లాజిక్ స్టెప్ సమస్యను పరిష్కరించడంలో అర్ధవంతంగా సహాయపడుతుందా అనే అంశాన్ని అంచనా వేయండి. "
           "కేవలం 'విశ్లేషణ: ఖచ్చితంగా', 'విశ్లేషణ: బహుశా', లేదా 'విశ్లేషణ: అసాధ్యం' అనే మూడు ఎంపికలలో ఒకదాన్ని మాత్రమే ఇవ్వండి. "
           "ఎలాంటి వివరణలు లేదా అదనపు వచనం ఇవ్వకండి.\n\n"
           "ఈ క్రింది తీర్పుల్లో ఒకదాన్ని ఎంచుకోండి:\n"
           "- ఖచ్చితంగా: ఈ దశ సరిగ్గా ఉంది మరియు పరిష్కార దిశగా సరైన పురోగతి.\n"
           "- బహుశా: ఈ దశ సాధ్యమే అయినా, మరింత మెరుగుదల అవసరం లేదా కొన్ని వివరాలు మిస్సయ్యాయి.\n"
           "- అసాధ్యం: ఈ దశ తప్పుగా ఉంది, సంబంధితం కాదు, లేదా తెలిసిన సత్యాలను వ్యతిరేకిస్తుంది.\n\n"
           "---\n"
           "ప్రశ్న: ఒక రైలు A స్టేషన్ నుండి 50 మంది ప్రయాణీకులతో బయలుదేరింది. "
           "తదుపరి స్టేషన్‌లో 15 మంది దిగిపోయారు, 30 మంది కొత్తగా ఎక్కారు. "
           "ఇప్పుడు రైలులో మొత్తం ప్రయాణీకుల సంఖ్య ఎంత?\n\n"
           "నిర్దేశిత తదుపరి దశ: స్థూల మార్పును లెక్కించండి: -15 + 30.\nవిశ్లేషణ: ఖచ్చితంగా\n\n"
           "నిర్దేశిత తదుపరి దశ: సమీకరణంగా వ్యక్తీకరించండి: 50 - 15 + 30 = x.\nవిశ్లేషణ: ఖచ్చితంగా\n\n"
           "నిర్దేశిత తదుపరి దశ: రైలు 20 మంది ప్రయాణీకులను కోల్పోయిందని ఊహించి మొత్తం సరిపోతుందా అని చూడండి.\nవిశ్లేషణ: అసాధ్యం\n\n"
) + "---\n" \
    "{question}\n\n" \
    "నిర్దేశిత తదుపరి దశ: {curr_candidate}\n\n" \
    "విశ్లేషణ:" \
    + MODEL_CHAT_TEMPLATE

# Force output prompt
force_output_prompt = USER_CHAT_TEMPLATE.format(
    prompt="కింద ఇచ్చిన మొత్తం సమాచారాన్ని ఆధారంగా సమస్యకు తుది సమాధానం రూపొందించండి.\n\n"
           "ఈ నియమాలను ఖచ్చితంగా పాటించండి:\n"
           "- ప్రతి గణనను స్పష్టంగా, దశల వారీగా వివరించండి.\n"
           "- సమకాలీన సమాచారాన్ని ఉపయోగించి ప్రతి దశను ముందుకు తీసుకెళ్లండి.\n"
           "- ఇప్పటికే ఇచ్చిన దశలను పునరావృతం చేయవద్దు.\n"
           "- చివరి లైన్‌లో కేవలం సంఖ్య మాత్రమే సమాధానంగా ఇవ్వండి, అదనపు వచనం లేకుండా.\n\n"
           "ప్రసంగం (ఇంతకు ముందు ఆలోచనా విధానం ఉంటే):\n"
           "{context}\n\n"
) + "---\n" \
    "ప్రశ్న: {question}\n\n" \
    "పరిష్కారం:\n" \
    "దశ 1: " \
    + MODEL_CHAT_TEMPLATE

# Choose final answer
final_judge_prompt = USER_CHAT_TEMPLATE.format(
    prompt="మీరు ఒక గణిత న్యాయమూర్తి, సమస్యకు తుది సమాధానాన్ని నిర్ణయించాలి.\n\n"
           "ముందుగా, సమస్య వివరణను జాగ్రత్తగా విశ్లేషించండి. తర్వాత, క్రింది అభ్యర్థుల సమాధానాలను సమగ్రంగా పరిశీలించండి.\n"
           "ప్రతి సమాధానంలోని లాజిక్‌ను పోల్చి, అత్యంత ఖచ్చితమైన జవాబును గుర్తించండి.\n\n"
           "ఈ నియమాలను అనుసరించండి:\n"
           "- నిర్ణయం తీసుకునే ముందు సమస్యను లాజికల్‌గా విశ్లేషించండి.\n"
           "- ఒక కంటే ఎక్కువ సరైన సమాధానాలు ఉంటే, అత్యుత్తమమైనది ఎంచుకోండి.\n"
           "- సమాధానంలో ఏదైనా అసంగతి లేదా తప్పిపోయిన దశలు ఉంటే, దానిని పరిగణించవద్దు.\n"
           "- తుది సమాధానం కేవలం ఒక సంఖ్యగా ఇవ్వండి, అదనపు వచనం లేకుండా.\n\n"
           "---\n"
           "సమస్య వివరణ:\n"
           "{question}\n\n"
           "అభ్యర్థుల సమాధానాలు:\n"
           "{candidate_answers}\n\n"
           "---\n"
           "తుది సమాధానం: "
) + MODEL_CHAT_TEMPLATE